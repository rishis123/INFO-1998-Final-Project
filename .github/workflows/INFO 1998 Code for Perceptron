#Creator: Ethan Huang, Cornell University
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import Perceptron
from sklearn.metrics import accuracy_score

df = pd.read_csv("diabetes_012_health_indicators_BRFSS2015.csv")
features = df[["HighBP", "GenHlth", "BMI", "HighChol", "Age", "DiffWalk"]]
goal = (df["Diabetes_012"] == 2)

X_train, X_test, y_train, y_test = train_test_split(features, goal, test_size = 0.2, random_state = 42)

#train the perceptron model
model = Perceptron()

model.fit(X_train, y_train)

#Compute the train and test accuracy using accuracy_score
pred_train = model.predict(X_train)
pred_test = model.predict(X_test) 
train_accuracy = accuracy_score(y_train, pred_train)
test_accuracy = accuracy_score(y_test, pred_test)

print("train accuracy:\t", train_accuracy)
print("test accuracy:\t", test_accuracy)
